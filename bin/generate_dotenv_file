#!/bin/bash

set -e

# This script is used to generate a .env file using the 1Password CLI.

OP_ACCOUNT="farmgirl-flowers"
OP_ITEM="Engineering/strapi-aws-prod"

op_read() {
  op read op://${OP_ITEM}/${1} --account "${OP_ACCOUNT}"
}

STRAPI_TRANSFER_TOKEN=$(op read op://${OP_ITEM}/credential --account "${OP_ACCOUNT}")
STRAPI_FROM_URL=$(op read op://${OP_ITEM}/username --account "${OP_ACCOUNT}")

cp .env.example .env

echo "" >> .env
echo "" >> .env
echo "" >> .env
echo "# Generated by 1Password CLI" >> .env
echo "AWS_ACCESS_KEY_ID=$(op_read 'AWS_ACCESS_KEY_ID')" >> .env
echo "AWS_ACCESS_SECRET=$(op_read 'AWS_ACCESS_SECRET')" >> .env

echo "Done! See .env for your credentials."